import { existsSync, mkdirSync, readFileSync, writeFileSync } from 'node:fs';
import { parse } from 'node:path';
import comparePng from 'png-visual-compare';
export function comparePNG({ actualFile, expectedFile, createExpectedFileIfMissing, opts, }) {
    if (createExpectedFileIfMissing && !existsSync(expectedFile)) {
        const expectedFileDir = parse(expectedFile).dir;
        mkdirSync(expectedFileDir, { recursive: true });
        const actualBuffer = typeof actualFile === 'string' ? readFileSync(actualFile) : actualFile;
        writeFileSync(expectedFile, actualBuffer);
    }
    return comparePng(actualFile, expectedFile, opts);
}
